# Telegam bot for Flibusta [![Build Status](https://travis-ci.org/flicus/flibot.png)](https://travis-ci.org/flicus/flibot)
Бот позволяет искать и скачивать книги из онлайн библиотеки [Flibusta](http://www.flibusta.is). Использует [TOR](https://www.torproject.org) для доступа к [OPDS](https://ru.wikipedia.org/wiki/OPDS) каталогу Флибусты. Использует библиотеку [Telegram Bot API](https://github.com/rubenlagus/TelegramBots). Отвечает только администратору бота и пользователям, которых администратор добавил в список разрешенных.
## Установка
Для начала убедитесь что на хосте установлен tor. Так же боту для запуска нужна установленая Java 8. Установить бота на хост можно несколькими способами:
### Установка из исходных кодов
Установите [Git](https://git-scm.com/) если его еще нет , после чего клонируйте репозиторий бота к себе на хост:
```
git clone https://github.com/flicus/flibot
```
теперь можно скомпилировать бота:
```
cd flibot
gradlew shadowJar
```
если все прошло хорошо, бот готов к запуску, все необходимые библиотеки скачаны и помещены в starter/build/libs/starter-0.9.0-all.jar  
### Скачать готовый jar файл
 Скачать можно со странички [Release page](https://github.com/flicus/flibot/releases)
## Конфигурация
Перед тем как запустить бота, необходимо его сконфигурировать. Бот ищет конфигурационные параметры в переменных окружения. Если есть переменная flibot, бот считает что все параметы в переменных окружения и будет пытаться считать их оттуда. В противном случае бот ищет файл bot.ini в текущем каталоге и пытается считать параметры конфигурации из него.
### Параметры
- name    - имя (username) бота
- token   - токен бота
- usetor  - использовать ли tor
- torhost - хост где установлен tor 
- torport - tcp порт tor
- admin   - имя пользователя Telegram который будет администратором бота

### Пример файла bot.ini
```
name=test_bot
token=123456:blablabla
usetor=true
torhost=localhost
torport=9050
admin=myusername
```
## Запуск
Простейший способ запустить бота, запуск его как сервиса здесь не рассматривается
```
java -jar starter-0.9.0-all.jar &
```
### Поддерживаемые команды
Просто наберите имя автора или название книги в чате, бот спросит где это искать - среди авторов или названий книг. Дополнительно поддерживаются следующие команды:
```
/k                  - просмотр OPDS каталога
/r <username>       - добавить пользователя username в список разрешенных (доступна только администратору)
/u <username>       - удалить пользователя username из списка разрешенных (доступна только администратору)
```